From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: Tencryn <41876297+Tencryn@users.noreply.github.com>
Date: Sun, 21 Nov 2021 03:01:01 +0000
Subject: [PATCH] Disable Sheep Griefing Blocks


diff --git a/src/main/java/net/minecraft/world/entity/ai/goal/EatBlockGoal.java b/src/main/java/net/minecraft/world/entity/ai/goal/EatBlockGoal.java
index 8a4080a77bd5b73ac812e3ae67c6f21dcd270215..66496c00900883549032cd72bcb5a8cb7e9a256c 100644
--- a/src/main/java/net/minecraft/world/entity/ai/goal/EatBlockGoal.java
+++ b/src/main/java/net/minecraft/world/entity/ai/goal/EatBlockGoal.java
@@ -3,7 +3,11 @@ package net.minecraft.world.entity.ai.goal;
 import java.util.EnumSet;
 import java.util.function.Predicate;
 import net.minecraft.core.BlockPos;
+import net.minecraft.sounds.SoundEvents;
+import net.minecraft.sounds.SoundSource;
+import net.minecraft.world.entity.Entity;
 import net.minecraft.world.entity.Mob;
+import net.minecraft.world.entity.player.Player;
 import net.minecraft.world.level.GameRules;
 import net.minecraft.world.level.Level;
 import net.minecraft.world.level.block.Block;
@@ -69,10 +73,16 @@ public class EatBlockGoal extends Goal {
             BlockPos blockposition = this.mob.blockPosition();
 
             if (EatBlockGoal.IS_TALL_GRASS.test(this.level.getBlockState(blockposition))) {
-                // CraftBukkit
-                if (!CraftEventFactory.callEntityChangeBlockEvent(this.mob, blockposition, Blocks.AIR.defaultBlockState(), !this.level.purpurConfig.sheepBypassMobGriefing && !this.level.getGameRules().getBoolean(GameRules.RULE_MOBGRIEFING)).isCancelled()) { // Purpur
-                    this.level.destroyBlock(blockposition, false);
+                // Bamboo start
+                if (net.rocryn.bamboo.BambooConfig.sheepGriefGrass) {
+                    // CraftBukkit
+                    if (!CraftEventFactory.callEntityChangeBlockEvent(this.mob, blockposition, Blocks.AIR.defaultBlockState(), !this.level.purpurConfig.sheepBypassMobGriefing && !this.level.getGameRules().getBoolean(GameRules.RULE_MOBGRIEFING)).isCancelled()) { // Purpur
+                        this.level.destroyBlock(blockposition, false);
+                    }
+                } else {
+                    this.level.playSound((Player) null, (Entity) this.mob, SoundEvents.GRASS_BREAK, SoundSource.BLOCKS, 1.0f, 1.0f);
                 }
+                // Bamboo stop
 
                 this.mob.ate();
                 this.mob.gameEvent(GameEvent.EAT, this.mob.eyeBlockPosition());
@@ -80,11 +90,17 @@ public class EatBlockGoal extends Goal {
                 BlockPos blockposition1 = blockposition.below();
 
                 if (this.level.getBlockState(blockposition1).is(Blocks.GRASS_BLOCK)) {
-                    // CraftBukkit
-                    if (!CraftEventFactory.callEntityChangeBlockEvent(this.mob, blockposition1, Blocks.AIR.defaultBlockState(),  !this.level.purpurConfig.sheepBypassMobGriefing && !this.level.getGameRules().getBoolean(GameRules.RULE_MOBGRIEFING)).isCancelled()) { // Purpur
-                        this.level.levelEvent(2001, blockposition1, Block.getId(Blocks.GRASS_BLOCK.defaultBlockState()));
-                        this.level.setBlock(blockposition1, Blocks.DIRT.defaultBlockState(), 2);
+                    // Bamboo start
+                    if (net.rocryn.bamboo.BambooConfig.sheepGriefGrass) {
+                        // CraftBukkit
+                        if (!CraftEventFactory.callEntityChangeBlockEvent(this.mob, blockposition1, Blocks.AIR.defaultBlockState(), !this.level.purpurConfig.sheepBypassMobGriefing && !this.level.getGameRules().getBoolean(GameRules.RULE_MOBGRIEFING)).isCancelled()) { // Purpur
+                            this.level.levelEvent(2001, blockposition1, Block.getId(Blocks.GRASS_BLOCK.defaultBlockState()));
+                            this.level.setBlock(blockposition1, Blocks.DIRT.defaultBlockState(), 2);
+                        }
+                    } else {
+                        this.level.playSound((Player) null, (Entity) this.mob, SoundEvents.GRASS_BREAK, SoundSource.BLOCKS, 1.0f, 1.0f);
                     }
+                    // Bamboo stop
 
                     this.mob.ate();
                     this.mob.gameEvent(GameEvent.EAT, this.mob.eyeBlockPosition());
